/*
  Input parameters:
   - TestFixtureTypeFullName
   - SetupMethodName
   - TestName
   - TestParameters
   - IsAsync
*/

AuditVariablesAutoGenerated941C.Coverage.Clear();
string errorMessage=null;
bool ThrownException=false;

try
{
	Type testFixtureType = Type.GetType(TestFixtureTypeFullName);
	object testFixture = System.Activator.CreateInstance(testFixtureType);

	if(SetupMethodName != null)
		testFixtureType.GetMethod(SetupMethodName,BindingFlags.Instance|BindingFlags.Public|BindingFlags.NonPublic).Invoke(testFixture, null);

	if(IsAsync)
		((dynamic)testFixtureType.GetMethod(TestName, BindingFlags.Instance|BindingFlags.Public|BindingFlags.NonPublic).Invoke(testFixture, TestParameters)).Wait();
	else
		testFixtureType.GetMethod(TestName, BindingFlags.Instance|BindingFlags.Public|BindingFlags.NonPublic).Invoke(testFixture, TestParameters);
}
catch(AggregateException e)
{
	ThrownException=true; 
	errorMessage=e.InnerException.ToString();
}
catch(TargetInvocationException e){ThrownException=true; errorMessage=e.InnerException.ToString();}

var auditLog= AuditVariablesAutoGenerated941C.Coverage;
